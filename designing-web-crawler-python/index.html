<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="preload" href="/blog/component---src-layouts-index-js-29cb5c44085daafa2b8e.js" as="script"/><link rel="preload" href="/blog/component---src-templates-blog-post-js-89bb5a4bad2639e9770d.js" as="script"/><link rel="preload" href="/blog/path---designing-web-crawler-python-44017baaa1d3eeb9bfe4.js" as="script"/><link rel="preload" href="/blog/app-c4956923d82f6a9d6817.js" as="script"/><link rel="preload" href="/blog/commons-2c1f772de09748d79929.js" as="script"/><link rel="manifest" href="/blog/manifest.json"/><meta name="theme-color" content="white"/><title data-react-helmet="true">Daemons | Designing a Web Crawler</title><meta data-react-helmet="true" name="description" content="Scenario Given seeds, crawl the web How many web pages? 1 trillion web pages How long?  Crawl all of them every week How large? Average size…"/><link rel="icon" type="image/png" sizes="1024x1024" href="/blog/static/logo.9d37eac5.png"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.4 'Alegreya',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Alegreya',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;color:hsla(0,0%,0%,0.75);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;color:hsla(0,0%,0%,0.775);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;color:hsla(0,0%,0%,0.8);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;color:hsla(0,0%,0%,0.9);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;color:hsla(0,0%,0%,0.9);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;color:hsla(0,0%,0%,0.9);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;}ul{margin-left:1.4rem;margin-right:0;margin-top:0.7rem;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.4rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;font-size:0.85rem;line-height:1.22;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.05rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;font-size:1rem;line-height:1.4rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;}blockquote{margin-left:0;margin-right:1.4rem;margin-top:0;padding-bottom:0;padding-left:0.9625rem;padding-right:0;padding-top:0;margin-bottom:1.05rem;color:hsla(0,0%,0%,0.65);font-style:italic;border-left:0.4375rem solid hsla(0,0%,0%,0.5);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.05rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.05rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.05rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.4rem;margin-bottom:calc(1.05rem / 2);margin-top:calc(1.05rem / 2);}li > ul{margin-left:1.4rem;margin-bottom:calc(1.05rem / 2);margin-top:calc(1.05rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:0.7rem;}code{font-size:0.85rem;line-height:1.4rem;}kbd{font-size:0.85rem;line-height:1.4rem;}samp{font-size:0.85rem;line-height:1.4rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:0.93333rem;padding-right:0.93333rem;padding-top:0.7rem;padding-bottom:calc(0.7rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;font-size:85%;}pre code{background:none;line-height:1.42;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}h1,h2,h3,h4,h5,h6{line-height:1;}h1,h2,h3,h4{line-height:1;margin-top:1.4rem;margin-bottom:0.7rem;}h4,h5,h6{text-transformation:uppercase;}a{color:hsl(230,55%,58%);text-decoration:none;}a:hover,a:active{box-shadow:0 1px 0 0 currentColor;}blockquote > :last-child{margin-bottom:0;}@media only screen and (max-width:480px){html{font-size:112.5%;}blockquote{border-left:0.2625rem solid hsla(0,0%,0%,0.5);margin-left:-1.05rem;margin-right:0;padding-left:0.7875rem;}}blockquote > h1, blockquote > h2, blockquote > h3, blockquote > h4{margin-top:0;}p code{font-size:75%;}</style><style id="gatsby-inlined-css">@font-face{font-family:Alegreya;font-style:normal;font-display:swap;font-weight:400;src:local("Alegreya Regular "),local("Alegreya-Regular"),url(/blog/static/alegreya-latin-400.24fbcabd.woff2) format("woff2"),url(/blog/static/alegreya-latin-400.508293b9.woff) format("woff")}@font-face{font-family:Alegreya;font-style:italic;font-display:swap;font-weight:400;src:local("Alegreya Regular italic"),local("Alegreya-Regularitalic"),url(/blog/static/alegreya-latin-400italic.c8a1e4ae.woff2) format("woff2"),url(/blog/static/alegreya-latin-400italic.9e7a0928.woff) format("woff")}@font-face{font-family:Alegreya;font-style:normal;font-display:swap;font-weight:700;src:local("Alegreya Bold "),local("Alegreya-Bold"),url(/blog/static/alegreya-latin-700.3ec3004b.woff2) format("woff2"),url(/blog/static/alegreya-latin-700.3f647c3d.woff) format("woff")}@font-face{font-family:Alegreya;font-style:italic;font-display:swap;font-weight:700;src:local("Alegreya Bold italic"),local("Alegreya-Bolditalic"),url(/blog/static/alegreya-latin-700italic.23a153ec.woff2) format("woff2"),url(/blog/static/alegreya-latin-700italic.b2e3fada.woff) format("woff")}@font-face{font-family:Alegreya;font-style:normal;font-display:swap;font-weight:900;src:local("Alegreya Black "),local("Alegreya-Black"),url(/blog/static/alegreya-latin-900.46c45684.woff2) format("woff2"),url(/blog/static/alegreya-latin-900.b352c175.woff) format("woff")}@font-face{font-family:Alegreya;font-style:italic;font-display:swap;font-weight:900;src:local("Alegreya Black italic"),local("Alegreya-Blackitalic"),url(/blog/static/alegreya-latin-900italic.d2e82e8b.woff2) format("woff2"),url(/blog/static/alegreya-latin-900italic.c4c8cf1a.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:normal;font-display:swap;font-weight:100;src:local("Alegreya Sans Thin "),local("Alegreya Sans-Thin"),url(/blog/static/alegreya-sans-latin-100.45a8e96e.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-100.d44cabed.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:italic;font-display:swap;font-weight:100;src:local("Alegreya Sans Thin italic"),local("Alegreya Sans-Thinitalic"),url(/blog/static/alegreya-sans-latin-100italic.5142b88a.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-100italic.f7cd3496.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:normal;font-display:swap;font-weight:300;src:local("Alegreya Sans Light "),local("Alegreya Sans-Light"),url(/blog/static/alegreya-sans-latin-300.f3321ccf.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-300.d367a30e.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:italic;font-display:swap;font-weight:300;src:local("Alegreya Sans Light italic"),local("Alegreya Sans-Lightitalic"),url(/blog/static/alegreya-sans-latin-300italic.b0e07ba6.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-300italic.46762122.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:normal;font-display:swap;font-weight:400;src:local("Alegreya Sans Regular "),local("Alegreya Sans-Regular"),url(/blog/static/alegreya-sans-latin-400.3de041e5.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-400.ed12fcac.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:italic;font-display:swap;font-weight:400;src:local("Alegreya Sans Regular italic"),local("Alegreya Sans-Regularitalic"),url(/blog/static/alegreya-sans-latin-400italic.9465a336.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-400italic.8110b97c.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:normal;font-display:swap;font-weight:500;src:local("Alegreya Sans Medium "),local("Alegreya Sans-Medium"),url(/blog/static/alegreya-sans-latin-500.15ddffe3.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-500.74a11342.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:italic;font-display:swap;font-weight:500;src:local("Alegreya Sans Medium italic"),local("Alegreya Sans-Mediumitalic"),url(/blog/static/alegreya-sans-latin-500italic.b5ec9dc5.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-500italic.07c42835.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:normal;font-display:swap;font-weight:700;src:local("Alegreya Sans Bold "),local("Alegreya Sans-Bold"),url(/blog/static/alegreya-sans-latin-700.4b0948f6.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-700.2e56513c.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:italic;font-display:swap;font-weight:700;src:local("Alegreya Sans Bold italic"),local("Alegreya Sans-Bolditalic"),url(/blog/static/alegreya-sans-latin-700italic.4ed409f7.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-700italic.3f6cbbb0.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:normal;font-display:swap;font-weight:800;src:local("Alegreya Sans ExtraBold "),local("Alegreya Sans-ExtraBold"),url(/blog/static/alegreya-sans-latin-800.1c0e5aae.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-800.90d95c03.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:italic;font-display:swap;font-weight:800;src:local("Alegreya Sans ExtraBold italic"),local("Alegreya Sans-ExtraBolditalic"),url(/blog/static/alegreya-sans-latin-800italic.e8aae4da.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-800italic.ebc3fa33.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:normal;font-display:swap;font-weight:900;src:local("Alegreya Sans Black "),local("Alegreya Sans-Black"),url(/blog/static/alegreya-sans-latin-900.23dc5a13.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-900.f0423f38.woff) format("woff")}@font-face{font-family:Alegreya Sans;font-style:italic;font-display:swap;font-weight:900;src:local("Alegreya Sans Black italic"),local("Alegreya Sans-Blackitalic"),url(/blog/static/alegreya-sans-latin-900italic.e77626c6.woff2) format("woff2"),url(/blog/static/alegreya-sans-latin-900italic.58324fe2.woff) format("woff")}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#7d8b99}.token.punctuation{color:#5f6364}.token.boolean,.token.constant,.token.deleted,.token.function-name,.token.number,.token.property,.token.symbol,.token.tag{color:#c92c2c}.token.attr-name,.token.builtin,.token.char,.token.function,.token.inserted,.token.selector,.token.string{color:#2f9c0a}.token.entity,.token.operator,.token.url,.token.variable{color:#a67f59}.token.atrule,.token.attr-value,.token.class-name,.token.keyword{color:#1990b8}.token.important,.token.regex{color:#e90}.language-css .token.string,.style .token.string{color:#a67f59}.token.important{font-weight:400}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.namespace{opacity:.7}.token.cr:before,.token.lf:before,.token.tab:not(:empty):before{color:#e0d7d1}pre[class*=language-].line-numbers{padding-left:0}pre[class*=language-].line-numbers code{padding-left:3.8em}pre[class*=language-].line-numbers .line-numbers-rows{left:0}pre[class*=language-][data-line]{padding-top:0;padding-bottom:0;padding-left:0}pre[data-line] code{position:relative;padding-left:4em}pre .line-highlight{margin-top:0}</style></head><body><div id="___gatsby"><div style="padding:2.1rem 1.05rem;max-width:30.8rem;margin:0 auto;" data-reactroot="" data-reactid="1" data-react-checksum="-1455195359"><!-- react-empty: 2 --><div data-reactid="3"><a style="text-decoration:none;box-shadow:none;color:inherit;" href="/blog/" data-reactid="4"><h3 style="margin-top:0;" data-reactid="5">Daemons</h3></a></div><div data-reactid="6"><!-- react-empty: 7 --><h1 data-reactid="8">Designing a Web Crawler</h1><div data-reactid="9"><h2>Scenario</h2>
<ul>
<li>
<p>Given seeds, crawl the web</p>
<ul>
<li>
<p>How many web pages?</p>
<ul>
<li>1 trillion web pages</li>
</ul>
</li>
<li>
<p>How long? </p>
<ul>
<li>Crawl all of them every week</li>
</ul>
</li>
<li>
<p>How large?</p>
<ul>
<li>Average size of a web page: 10k</li>
<li>10p web page storage</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2>Initial design</h2>
<h3>A simplistic news crawler</h3>
<ul>
<li>
<p>Given the URL of news list page</p>
<ol>
<li>Send an HTTP request and grab the content of the news list page</li>
<li>Extract all the news titles from the news list page. (Regular expressions)</li>
</ol>
</li>
</ul>
<div class="gatsby-highlight">
      <pre class="language-python"><code class="language-python"><span class="token keyword">import</span> urllib2
url <span class="token operator">=</span> <span class="token string">'http://tech.163.com/it'</span>
<span class="token operator">//</span> get html
request <span class="token operator">=</span> urllib2<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
response <span class="token operator">=</span> urllib2<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>request<span class="token punctuation">)</span>
page <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">//</span> extract info using regular expressions
</code></pre>
      </div>
<h3>A single threaded web crawler</h3>
<ul>
<li>Input: Url seeds</li>
<li>Output: List of urls</li>
</ul>
<h4>Overview</h4>
<ul>
<li><a href="http://agiliq.com/blog/2013/10/producer-consumer-problem-in-python/">Producer-consumer implementation in Python</a></li>
</ul>
<div class="gatsby-highlight">
      <pre class="language-none"><code class="language-none">// breath first search, single-threaded crawler
function run
	while ( url_queue not empty )
		url = url_queue.dequeue()
		html = web_page_loader.load( url ) // consume
		url_list = url_extractor.extract( html ) // produce
		url_queue.enqueue_all( url_list )
	end</code></pre>
      </div>
<h4>Initial implementation</h4>
<ul>
<li>Problem: At some point, consumer has consumed everything and producer is still sleeping. Consumer tries to consume more but since queue is empty, an IndexError is raised.</li>
<li>Correct bnehavior: When there was nothing in the queue, consumer should have stopped running and waited instead of trying to consume from the queue. And once producer adds something to the queue, there should be a way for it to notify the consumer telling it has added something to queue. So, consumer can again consume from the queue. And thus IndexError will never be raised.</li>
</ul>
<div class="gatsby-highlight">
      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span> Lock
<span class="token keyword">import</span> time
<span class="token keyword">import</span> random

queue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
lock <span class="token operator">=</span> Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Producer keeps on adding to the queue </span>
<span class="token keyword">class</span> <span class="token class-name">ProducerThread</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        nums <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">#Will create the list [0, 1, 2, 3, 4]</span>
        <span class="token keyword">global</span> queue
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            num <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>nums<span class="token punctuation">)</span> <span class="token comment">#Selects a random number from list [0, 1, 2, 3, 4]</span>

            <span class="token comment"># queue is kept inside lock to avoid race condition</span>
            lock<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>
            queue<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>
            <span class="token keyword">print</span> <span class="token string">"Produced"</span><span class="token punctuation">,</span> num 
            lock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>

            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Consumer keeps on removing from the queue</span>
<span class="token keyword">class</span> <span class="token class-name">ConsumerThread</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">global</span> queue
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>

   			<span class="token comment"># queue is kept inside lock to avoid race condition</span>
            lock<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token operator">not</span> queue<span class="token punctuation">:</span>
                <span class="token keyword">print</span> <span class="token string">"Nothing in queue, but consumer will try to consume"</span>
            num <span class="token operator">=</span> queue<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span> <span class="token string">"Consumed"</span><span class="token punctuation">,</span> num 
            lock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>

            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># start one producer thread and one consumer thread</span>
ProducerThread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
ConsumerThread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
      </div>
<h4>Improve with Condition</h4>
<ul>
<li>
<p>Condition object allows one or more threads to wait until notified by another thread. And this is exactly what we want. We want consumer to wait when the queue is empty and resume only when it gets notified by the producer. Producer should notify only after it adds something to the queue. So after notification from producer, we can be sure that queue is not empty and hence no error can crop if consumer consumes.</p>
<ul>
<li>Condition is always associated with a lock</li>
<li>A condition has acquire() and release() methods that call the corresponding methods of the associated lock. Condition provides acquire() and release() which calls lock’s acquire() and release() internally, and so we can replace lock instances with condition instances and our lock behaviour will keep working properly.</li>
<li>Consumer needs to wait using a condition instance and producer needs to notify the consumer using the condition instance too. So, they must use the same condition instance for the wait and notify functionality to work properly.</li>
</ul>
</li>
</ul>
<div class="gatsby-highlight">
      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> threading <span class="token keyword">import</span> Condition

condition <span class="token operator">=</span> Condition<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">ConsumerThread</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">global</span> queue
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            condition<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment"># Check if the queue is empty before consuming. If yes then call wait() on condition instance. </span>
            <span class="token comment"># wait() blocks the consumer and also releases the lock associated with the condition. This lock was held by consumer, so basically consumer loses hold of the lock.</span>
            <span class="token comment"># Now unless consumer is notified, it will not run.</span>
            <span class="token keyword">if</span> <span class="token operator">not</span> queue<span class="token punctuation">:</span>
                <span class="token keyword">print</span> <span class="token string">"Nothing in queue, consumer is waiting"</span>
                condition<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span> <span class="token string">"Producer added something to queue and notified the consumer"</span>
            num <span class="token operator">=</span> queue<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span> <span class="token string">"Consumed"</span><span class="token punctuation">,</span> num 
            condition<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">ProducerThread</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        nums <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token keyword">global</span> queue
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
			<span class="token comment"># Producer can acquire the lock because lock was released by consumer</span>
            condition<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment"># Producer puts data in queue and calls notify() on the condition instance.</span>
            num <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>nums<span class="token punctuation">)</span>
            queue<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>
            <span class="token keyword">print</span> <span class="token string">"Produced"</span><span class="token punctuation">,</span> num 

            <span class="token comment"># Once notify() call is made on condition, consumer wakes up. But waking up doesn't mean it starts executing. notify() does not release the lock. Even after notify(), lock is still held by producer.</span>
            condition<span class="token punctuation">.</span>notify<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment"># Producer explicitly releases the lock by using condition.release().</span>
            condition<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment"># And consumer starts running again. Now it will find data in queue and no IndexError will be raised.</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            
</code></pre>
      </div>
<h4>Add a max size on the queue</h4>
<div class="gatsby-highlight">
      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span> Condition
<span class="token keyword">import</span> time
<span class="token keyword">import</span> random

queue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
MAX_NUM <span class="token operator">=</span> <span class="token number">10</span>
condition <span class="token operator">=</span> Condition<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">ProducerThread</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        nums <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token keyword">global</span> queue
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            condition<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment"># Before putting data in queue, producer should check if the queue is full. </span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span> <span class="token operator">==</span> MAX_NUM<span class="token punctuation">:</span>
            	<span class="token comment"># If the queue is full, producer must wait. So call wait() on condition instance to accomplish this.</span>
            	<span class="token comment"># This gives a chance to consumer to run. Consumer will consume data from queue which will create space in queue.</span>
                <span class="token keyword">print</span> <span class="token string">"Queue full, producer is waiting"</span>

                <span class="token comment"># And then consumer should notify the producer.</span>
                condition<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span> <span class="token string">"Space in queue, Consumer notified the producer"</span>

            <span class="token comment"># Once consumer releases the lock, producer can acquire the lock and can add data to queue.    </span>
            num <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>nums<span class="token punctuation">)</span>
            queue<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>
            <span class="token keyword">print</span> <span class="token string">"Produced"</span><span class="token punctuation">,</span> num
            condition<span class="token punctuation">.</span>notify<span class="token punctuation">(</span><span class="token punctuation">)</span>
            condition<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">ConsumerThread</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">global</span> queue
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            condition<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token operator">not</span> queue<span class="token punctuation">:</span>
                <span class="token keyword">print</span> <span class="token string">"Nothing in queue, consumer is waiting"</span>
                condition<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span> <span class="token string">"Producer added something to queue and notified the consumer"</span>
            num <span class="token operator">=</span> queue<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span> <span class="token string">"Consumed"</span><span class="token punctuation">,</span> num
            condition<span class="token punctuation">.</span>notify<span class="token punctuation">(</span><span class="token punctuation">)</span>
            condition<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


ProducerThread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
ConsumerThread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
      </div>
<h4>Use a queue instead</h4>
<ul>
<li>Queue encapsulates the behaviour of Condition, wait(), notify(), acquire() etc.</li>
</ul>
<div class="gatsby-highlight">
      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread
<span class="token keyword">import</span> time
<span class="token keyword">import</span> random
<span class="token keyword">from</span> Queue <span class="token keyword">import</span> Queue

queue <span class="token operator">=</span> Queue<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">ProducerThread</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        nums <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token keyword">global</span> queue
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            num <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>nums<span class="token punctuation">)</span>
            <span class="token comment"># Producer uses put available on queue to insert data in the queue.</span>
			<span class="token comment"># put() has the logic to acquire the lock before inserting data in queue.</span>
			<span class="token comment"># Also put() checks whether the queue is full. If yes, then it calls wait() internally and so producer starts waiting.</span>
            queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span>num<span class="token punctuation">)</span>
            <span class="token keyword">print</span> <span class="token string">"Produced"</span><span class="token punctuation">,</span> num
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">ConsumerThread</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">global</span> queue
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
			<span class="token comment"># Consumer uses get.</span>
			<span class="token comment"># get() acquires the lock before removing data from queue.</span>
			<span class="token comment"># get() checks if the queue is empty. If yes, it puts consumer in waiting state.</span>
			<span class="token comment"># get() and put() has proper logic for notify() too. Why don't you check the source code for Queue now?</span>
            num <span class="token operator">=</span> queue<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
            queue<span class="token punctuation">.</span>task_done<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span> <span class="token string">"Consumed"</span><span class="token punctuation">,</span> num
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


ProducerThread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
ConsumerThread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
      </div>
<h3>A multi-threaded web crawler</h3>
<ul>
<li>
<p>How different threads work together</p>
<ul>
<li>sleep: Stop a random interval and come back to see whether the resource is available to use. </li>
<li>condition variable: As soon as the resource is released by other threads, you could get it immediately.</li>
<li>semaphore: Allowing multiple number of threads to occupy a resource simultaneously. Number of semaphore set to 1. </li>
</ul>
</li>
<li>
<p>However, more threads doesn’t necessarily mean more performance. The number of threads on a single machine is limited because:</p>
<ul>
<li>Context switch cost ( CPU number limitation )</li>
<li>
<p>Thread number limitation</p>
<ul>
<li>TCP/IP limitation on number of threads</li>
</ul>
</li>
<li>Network bottleneck for single machine</li>
</ul>
</li>
</ul>
<h3>A distributed web crawler</h3>
<ul>
<li>
<p>URL queue is inside memory. Queue is too big to completely fit into memory. Use a MySQL DB task table</p>
<ul>
<li>state (working/idle): Whether it is being crawling.</li>
<li>priority (1/0): </li>
<li>available time: frequency. When to fetch the next time.</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>id</th>
<th>url</th>
<th>state</th>
<th>priority</th>
<th>available_time</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>“
<a href="http://www.sina.com/%E2%80%9D">http://www.sina.com/”</a></td>
<td>“idle”</td>
<td>1</td>
<td>“2016-03-04 11:00 am”</td>
</tr>
<tr>
<td>2</td>
<td>“
<a href="http://www.sina1.com/%E2%80%9D">http://www.sina1.com/”</a></td>
<td>“working”</td>
<td>1</td>
<td>“2016-03-04 12:00 am”</td>
</tr>
<tr>
<td>3</td>
<td>“
<a href="http://www.sina2.com/%E2%80%9D">http://www.sina2.com/”</a></td>
<td>“idle”</td>
<td>0</td>
<td>“2016-03-14 02:00 pm”</td>
</tr>
<tr>
<td>4</td>
<td>“
<a href="http://www.sina3.com/%E2%80%9D">http://www.sina3.com/”</a></td>
<td>“idle”</td>
<td>2</td>
<td>“2016-03-12 04:25 am”</td>
</tr>
</tbody>
</table>
<h2>Service</h2>
<ul>
<li>Crawler service</li>
<li>Task service</li>
<li>Storage service</li>
</ul>
<h2>Scale</h2>
<h3>Shard task table</h3>
<ul>
<li>Horizontal sharding</li>
</ul>
<h3>How to handle update for failure</h3>
<ul>
<li>
<p>Exponential back-off</p>
<ul>
<li>Success: crawl after 1 week</li>
<li>no.1 failure: crawl after 2 weeks</li>
<li>no.2 failure: crawl after 4 weeks</li>
<li>no.3 failure: crawl after 8 weeks</li>
</ul>
</li>
</ul>
<h3>How to handle dead cycle</h3>
<ul>
<li>Too many web pages in sina.com, the crawler keeps crawling sina.com and don’t crawl other websites</li>
<li>Use quota (10%)</li>
</ul>
<h3>Multi-region</h3>
<ul>
<li>When Google’s webpage crawls China’s webpages, it will be really really slow. Deploy crawler servers in multiple regions.</li>
</ul></div><em style="font-size:0.87055rem;line-height:1.4rem;display:block;margin-bottom:1.4rem;" data-reactid="10"><!-- react-text: 11 -->Tagged with <!-- /react-text --><span data-reactid="12"><a href="/blog/tags/design/" data-reactid="13">Design</a><span data-reactid="14"> | </span></span><span data-reactid="15"><a href="/blog/tags/web-crawler/" data-reactid="16">Web Crawler</a><span data-reactid="17"> | </span></span><span data-reactid="18"><a href="/blog/tags/python/" data-reactid="19">Python</a></span></em><p style="font-size:0.87055rem;line-height:1.4rem;display:block;margin-bottom:1.4rem;" data-reactid="20"><!-- react-text: 21 -->Posted <!-- /react-text --><!-- react-text: 22 -->August 25, 2017<!-- /react-text --></p><hr style="margin-bottom:1.4rem;" data-reactid="23"/><!-- react-empty: 24 --><p style="margin-bottom:0;" data-reactid="25"><img src="/blog/static/naqushab.7bf6cdfd.jpg" style="border-radius:100%;float:left;margin-right:0.35rem;margin-bottom:0;width:2.8rem;height:2.8rem;" data-reactid="26"/><strong data-reactid="27">Naqushab Neyazee</strong><!-- react-text: 28 --> is Senior Software Engineer at Adobe and is fond of dabbling with new technologies.<!-- /react-text --><!-- react-text: 29 --> <!-- /react-text --><a href="https://twitter.com/naqushab" data-reactid="30">You can follow him on Twitter</a></p></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-c4956923d82f6a9d6817.js","99219681209289":"component---node-modules-gatsby-plugin-offline-app-shell-js-5c4c5a0f7af9dc69d6d7.js","107818501498521":"component---src-templates-blog-post-js-89bb5a4bad2639e9770d.js","77653406118394":"component---src-templates-tag-page-js-1a69174989d4259991b2.js","162898551421021":"component---src-pages-404-js-0e19ea7873fcecc0a8e6.js","35783957827783":"component---src-pages-index-js-992b27f6bc127a2f3a48.js","195850678278728":"component---src-pages-tags-js-7dd52250c8f07745c3a9.js","60335399758886":"path----557518bd178906f8d58a.js","210333531512890":"path---offline-plugin-app-shell-fallback-a0e39f21c11f6a62c5ab.js","69145932705660":"path---trie-dictionary-spellcheck-f4883cfb425e8292b0de.js","101975605849084":"path---designing-web-crawler-python-44017baaa1d3eeb9bfe4.js","231018187067477":"path---hashmap-implementation-in-c-32927d171695b6fcbb4a.js","2316851250784":"path---string-searching-kmp-3575860f4165b8748191.js","10244422702148":"path---ternary-search-101-3b594fcd3fd3643ddf0b.js","94521927528854":"path---producer-consumer-problem-b983c8a8e6b24e57d423.js","32133537283428":"path---read-it-later-flask-python-b3b0b730e1c84c8f4d4c.js","143636244201540":"path---greedy-vs-dynamic-programming-adab4b9ddd07660d29e6.js","78289174550869":"path---system-design-overview-018d0e5f6f55b9749b50.js","77232207595528":"path---heap-implementation-c-bfe57a95992ff77f87d7.js","162874634297551":"path---tags-data-structures-051599a9f1fb19032738.js","44596054845757":"path---tags-trie-90c76bbea9a72ce89603.js","65951750749414":"path---tags-design-7ec806c23d99c953db27.js","38699965319050":"path---tags-web-crawler-04b56649263872b95cf7.js","7538477671963":"path---tags-python-f4f4ebfe715a7f8ca8d3.js","99965129943657":"path---tags-c-1e425862033880bbc612.js","159304943229617":"path---tags-hash-map-b0f953885d322cd69b78.js","11743349734324":"path---tags-kmp-83ae4cde253dbae328b4.js","120440209855454":"path---tags-string-fab0a97c9d60ffbf377f.js","27451989507627":"path---tags-searching-be6e187295a0818fc8c3.js","44727209576107":"path---tags-algorithm-948040e1057171ae24cc.js","94738983780980":"path---tags-producer-consumer-2f7de3ac2af36eb6c61b.js","212499019225397":"path---tags-multi-threading-eff49fd2220822d6d2bc.js","74044735890678":"path---tags-newspaper-818c0597a5eff9184d10.js","168269638805844":"path---tags-read-it-later-4f804814d24b618bc5d5.js","111067841283694":"path---tags-greedy-solution-6567c595a6053e868189.js","100009293837733":"path---tags-dynamic-programming-f363feed802a6cccd11f.js","114677301390673":"path---tags-system-design-869b3ec409869b9a9734.js","61904248049707":"path---tags-overview-73e03fc773ad551b82cf.js","129786605155348":"path---tags-heap-7e92679d72a1dd5499ac.js","174452259362052":"path---tags-data-structure-e34a6e72f73db420743e.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","142629428675168":"path---index-a4e99ab125fc39dabb8b.js","55702396619907":"path---tags-9be47b6ffba440308654.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-29cb5c44085daafa2b8e.js"}/*]]>*/</script><script>
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-105356281-1', 'auto');
      }
      </script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/blog/commons-2c1f772de09748d79929.js","/blog/app-c4956923d82f6a9d6817.js","/blog/path---designing-web-crawler-python-44017baaa1d3eeb9bfe4.js","/blog/component---src-templates-blog-post-js-89bb5a4bad2639e9770d.js","/blog/component---src-layouts-index-js-29cb5c44085daafa2b8e.js"])/*]]>*/</script></body></html>